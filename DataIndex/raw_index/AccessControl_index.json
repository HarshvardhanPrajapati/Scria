[
    {
        "id": "AccessControl_contract_context",
        "chunk_type": "CONTRACT_CONTEXT",
        "source_contract": "AccessControl.sol",
        "target_function": "ALL",
        "text_chunk": "// SPDX-License-Identifier: MIT\n// OpenZeppelin Contracts (last updated v4.6.0) (access/AccessControl.sol)\n\npragma solidity ^0.8.0;\n\nimport \"./IAccessControl.sol\";\nimport \"../utils/Context.sol\";\nimport \"../utils/Strings.sol\";\nimport \"../utils/introspection/ERC165.sol\";\n\nabstract contract AccessControl is Context, IAccessControl, ERC165 {\n    struct RoleData {\n        mapping(address => bool) members;\n        bytes32 adminRole;\n    }\n\n    mapping(bytes32 => RoleData) private _roles;\n\n    bytes32 public constant DEFAULT_ADMIN_ROLE = 0x00;\n\n    modifier onlyRole(bytes32 role) {\n        _checkRole(role);\n        _;\n    }\n\n    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {\n        return interfaceId == type(IAccessControl).interfaceId || super.supportsInterface(interfaceId);\n    }\n\n    function hasRole(bytes32 role, address account) public view virtual override returns (bool) {\n        return _roles[role].members[account];\n    }\n\n    function _checkRole(bytes32 role) internal view virtual {\n        _checkRole(role, _msgSender());\n    }\n\n    function _checkRole(bytes32 role, address account) internal view virtual {\n        if (!hasRole(role, account)) {\n            revert(\n                string(\n                    abi.encodePacked(\n                        \"AccessControl: account \",\n                        Strings.toHexString(uint160(account), 20),\n                        \" is missing role \",\n                        Strings.toHexString(uint256(role), 32)\n                    )\n                )\n            );\n        }\n    }\n\n    function getRoleAdmin(bytes32 role) public view virtual override returns (bytes32) {\n        return _roles[role].adminRole;\n    }\n\n    function grantRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {\n        _grantRole(role, account);\n    }\n\n    function revokeRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {\n        _revokeRole(role, account);\n    }\n\n    function renounceRole(bytes32 role, address account) public virtual override {\n        require(account == _msgSender(), \"AccessControl: can only renounce roles for self\");\n\n        _revokeRole(role, account);\n    }\n\n    function _setupRole(bytes32 role, address account) internal virtual {\n        _grantRole(role, account);\n    }\n\n    function _setRoleAdmin(bytes32 role, bytes32 adminRole) internal virtual {\n        bytes32 previousAdminRole = getRoleAdmin(role);\n        _roles[role].adminRole = adminRole;\n        emit RoleAdminChanged(role, previousAdminRole, adminRole);\n    }\n\n    function _grantRole(bytes32 role, address account) internal virtual {\n        if (!hasRole(role, account)) {\n            _roles[role].members[account] = true;\n            emit RoleGranted(role, account, _msgSender());\n        }\n    }\n\n    function _revokeRole(bytes32 role, address account) internal virtual {\n        if (hasRole(role, account)) {\n            _roles[role].members[account] = false;\n            emit RoleRevoked(role, account, _msgSender());\n        }\n    }\n}\n",
        "formal_property": null,
        "nl_summary": "",
        "metadata": {
            "function_list": [
                "supportsInterface",
                "hasRole",
                "_checkRole",
                "getRoleAdmin",
                "grantRole",
                "revokeRole",
                "renounceRole",
                "_setupRole",
                "_setRoleAdmin",
                "_grantRole",
                "_revokeRole"
            ],
            "state_variables": [
                "_roles",
                "members",
                "adminRole"
            ],
            "is_standard": "UNKNOWN"
        }
    },
    {
        "id": "AccessControl_onlyRoleModifierCheckGrant_8232504e",
        "chunk_type": "FUNCTION_RULE",
        "source_contract": "AccessControl.sol",
        "target_function": "_checkRole/getRoleAdmin/grantRole",
        "text_chunk": "    function _checkRole(bytes32 role, address account) internal view virtual {\n        if (!hasRole(role, account)) {\n            revert(\n                string(\n                    abi.encodePacked(\n                        \"AccessControl: account \",\n                        Strings.toHexString(uint160(account), 20),\n                        \" is missing role \",\n                        Strings.toHexString(uint256(role), 32)\n                    )\n                )\n            );\n        }\n    }\n\n\n    function getRoleAdmin(bytes32 role) public view virtual override returns (bytes32) {\n        return _roles[role].adminRole;\n    }\n\n\n    function grantRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {\n        _grantRole(role, account);\n    }\n",
        "formal_property": "rule onlyRoleModifierCheckGrant(env e){\n    bytes32 role; address account;\n\n    _checkRole@withrevert(e, getRoleAdmin(role));\n    bool checkRevert = lastReverted;\n    grantRole@withrevert(e, role, account);\n    bool grantRevert = lastReverted;\n    assert checkRevert => grantRevert, \"modifier goes bananas\";\n}\n",
        "nl_summary": "",
        "metadata": {
            "rule_name": "onlyRoleModifierCheckGrant",
            "rule_type": "rule",
            "modifies_state": false,
            "methods_in_block": [
                "grantRole",
                "_checkRole",
                "getRoleAdmin"
            ],
            "start_line": 15,
            "end_line": 25,
            "block_hash": "8232504e5c1ce2f3073a01b0a236dacf"
        }
    },
    {
        "id": "AccessControl_onlyRoleModifierCheckRevoke_e572ecc0",
        "chunk_type": "FUNCTION_RULE",
        "source_contract": "AccessControl.sol",
        "target_function": "_checkRole/getRoleAdmin/revokeRole",
        "text_chunk": "    function _checkRole(bytes32 role, address account) internal view virtual {\n        if (!hasRole(role, account)) {\n            revert(\n                string(\n                    abi.encodePacked(\n                        \"AccessControl: account \",\n                        Strings.toHexString(uint160(account), 20),\n                        \" is missing role \",\n                        Strings.toHexString(uint256(role), 32)\n                    )\n                )\n            );\n        }\n    }\n\n\n    function getRoleAdmin(bytes32 role) public view virtual override returns (bytes32) {\n        return _roles[role].adminRole;\n    }\n\n\n    function revokeRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {\n        _revokeRole(role, account);\n    }\n",
        "formal_property": "rule onlyRoleModifierCheckRevoke(env e){\n    bytes32 role; address account;\n\n    _checkRole@withrevert(e, getRoleAdmin(role));\n    bool checkRevert = lastReverted;\n    revokeRole@withrevert(e, role, account);\n    bool revokeRevert = lastReverted;\n    assert checkRevert => revokeRevert, \"modifier goes bananas\";\n}\n",
        "nl_summary": "",
        "metadata": {
            "rule_name": "onlyRoleModifierCheckRevoke",
            "rule_type": "rule",
            "modifies_state": false,
            "methods_in_block": [
                "revokeRole",
                "_checkRole",
                "getRoleAdmin"
            ],
            "start_line": 30,
            "end_line": 40,
            "block_hash": "e572ecc0490748a062af664bc4d17d71"
        }
    },
    {
        "id": "AccessControl_grantRoleEffect_83e15d77",
        "chunk_type": "FUNCTION_RULE",
        "source_contract": "AccessControl.sol",
        "target_function": "grantRole/hasRole",
        "text_chunk": "    function grantRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {\n        _grantRole(role, account);\n    }\n\n\n    function hasRole(bytes32 role, address account) public view virtual override returns (bool) {\n        return _roles[role].members[account];\n    }\n",
        "formal_property": "rule grantRoleEffect(env e){\n    bytes32 role; address account; \n    bytes32 anotherRole; address nonEffectedAcc;\n    require account != nonEffectedAcc;\n\n    bool hasRoleBefore = hasRole(anotherRole, nonEffectedAcc);\n    grantRole(e, role, account);\n    bool hasRoleAfter = hasRole(anotherRole, nonEffectedAcc);\n    assert hasRoleBefore == hasRoleAfter, \"modifier goes bananas\";\n}\n",
        "nl_summary": "",
        "metadata": {
            "rule_name": "grantRoleEffect",
            "rule_type": "rule",
            "modifies_state": false,
            "methods_in_block": [
                "grantRole",
                "hasRole"
            ],
            "start_line": 45,
            "end_line": 57,
            "block_hash": "83e15d775796166e9d8d04c38f460241"
        }
    },
    {
        "id": "AccessControl_revokeRoleEffect_382b0739",
        "chunk_type": "FUNCTION_RULE",
        "source_contract": "AccessControl.sol",
        "target_function": "hasRole/revokeRole",
        "text_chunk": "    function hasRole(bytes32 role, address account) public view virtual override returns (bool) {\n        return _roles[role].members[account];\n    }\n\n\n    function revokeRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {\n        _revokeRole(role, account);\n    }\n",
        "formal_property": "rule revokeRoleEffect(env e){\n    bytes32 role; address account; \n    bytes32 anotherRole; address nonEffectedAcc;\n    require account != nonEffectedAcc;\n\n    bool hasRoleBefore = hasRole(anotherRole, nonEffectedAcc);\n    revokeRole(e, role, account);\n    bool hasRoleAfter = hasRole(anotherRole, nonEffectedAcc);\n    assert hasRoleBefore == hasRoleAfter, \"modifier goes bananas\";\n}",
        "nl_summary": "",
        "metadata": {
            "rule_name": "revokeRoleEffect",
            "rule_type": "rule",
            "modifies_state": false,
            "methods_in_block": [
                "revokeRole",
                "hasRole"
            ],
            "start_line": 62,
            "end_line": 74,
            "block_hash": "382b073948f6f3998d1f49f1ffca4561"
        }
    }
]